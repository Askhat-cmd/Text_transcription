–î–∞, –≤ –ø—Ä–æ–µ–∫—Ç–µ —Å–µ–π—á–∞—Å –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–≤–∞ —Ñ–∞–π–ª–∞ —Å –ø–æ—Ö–æ–∂–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º, –Ω–æ –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (—Ö–æ—Ç—è –µ—Å—Ç—å —è–≤–Ω–æ–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞, —á—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∏–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞).

1.  **`voice_bot_pipeline/text_processor/sarsekenov_processor.py`** (—Ç–æ—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã —Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–ª–∏)
    *   **–†–æ–ª—å:** –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π, "—Ä–∞–±–æ—á–∏–π" –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–º `pipeline_orchestrator.py`.
    *   **–§—É–Ω–∫—Ü–∏–∏:** –û–Ω –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–æ–π —Å—É–±—Ç–∏—Ç—Ä–æ–≤, –Ω–∞—Ä–µ–∑–∫–æ–π –Ω–∞ —á–∞–Ω–∫–∏ (chunking), –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —Å OpenAI –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞, –∞ —Ç–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ SAG v2.0 —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä—ã (`Safety`, `CausalChain`, `Hierarchy` –∏ —Ç.–¥.) –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –±–ª–æ–∫–æ–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏. –û–Ω —Ç–∞–∫–∂–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π JSON –∏ Markdown.
    *   **–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ production-–ø–∞–π–ø–ª–∞–π–Ω–µ.

2.  **`voice_bot_pipeline/text_processor/orchestrator/sarsekenov_processor.py`**
    *   **–†–æ–ª—å:** –≠—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã "–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä", –≤–µ—Ä–æ—è—Ç–Ω–æ, –∑–∞–¥—É–º–∞–Ω–Ω—ã–π –∫–∞–∫ —Å–ª–µ–¥—É—é—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.
    *   **–§—É–Ω–∫—Ü–∏–∏:** –û–Ω —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ **Knowledge Graph** (–≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π). –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —É–∂–µ –≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç (–∏–ª–∏ –±–ª–æ–∫–∏) –∏ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ –∏–º–µ–Ω–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–∑–ª–æ–≤ –∏ —Å–≤—è–∑–µ–π –≥—Ä–∞—Ñ–∞ (`GraphNode`, `GraphEdge`), –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è JSON-—Ñ–∞–π–ª–∞. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Å—ã `ProcessingResult`, `KnowledgeGraph` –∏ –∏–º–µ–µ—Ç –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é.
    *   **–°—Ç–∞—Ç—É—Å:** –ü–æ—Ö–æ–∂–µ –Ω–∞ "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –±—É–¥—É—â–µ–µ" –∏–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–≤—è–∑–µ–π, –Ω–æ –≤ —Ç–µ–∫—É—â–µ–º –ª–æ–≥–µ –∑–∞–ø—É—Å–∫–∞ `pipeline_orchestrator.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª.

**–†–µ–∑—é–º–µ:**
*   –ü–µ—Ä–≤—ã–π —Ñ–∞–π–ª (`text_processor/sarsekenov_processor.py`) ‚Äî —ç—Ç–æ **ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä** (Extract, Transform, Load), –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö.
*   –í—Ç–æ—Ä–æ–π —Ñ–∞–π–ª (`orchestrator/sarsekenov_processor.py`) ‚Äî —ç—Ç–æ **–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–≤–∏–∂–æ–∫** –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π.

–í –±—É–¥—É—â–µ–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏—Ö –∏–ª–∏ —á–µ—Ç–∫–æ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∑–æ–Ω—ã –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–≤—ã–π –≥–æ—Ç–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ, –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∏—Ç –ø–æ –Ω–∏–º –≥—Ä–∞—Ñ), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—ã.

***

# üéØ **–ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø AI-–ê–ì–ï–ù–¢–ê CURSOR**

## **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Knowledge Graph Builder –≤ Production Pipeline**

**–¶–ï–õ–¨:** –°–æ–∑–¥–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–ª–Ω—É—é –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –¥–ª—è AI-–±–æ—Ç–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞ —Å –≥–ª—É–±–æ–∫–∏–º–∏ —Å–≤—è–∑—è–º–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ü–µ–ø—Ç–∞–º–∏.

***

## üìã **–®–ê–ì 1: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è**

### **1.1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª orchestrator –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞**

```bash
# –î–µ–π—Å—Ç–≤–∏–µ: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—É—Ç–∞–Ω–∏—Ü—ã
–°—Ç–∞—Ä–æ–µ –∏–º—è: text_processor/orchestrator/sarsekenov_processor.py
–ù–æ–≤–æ–µ –∏–º—è: text_processor/orchestrator/knowledge_graph_builder.py
```


### **1.2. –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Å –≤ —Ñ–∞–π–ª–µ**

–û—Ç–∫—Ä—ã—Ç—å `text_processor/orchestrator/knowledge_graph_builder.py` –∏:

```python
# –ó–ê–ú–ï–ù–ò–¢–¨:
class SarsekenovProcessor:
    """–ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤ –°–∞—Ä—Å–µ–∫–µ–Ω–æ–≤–∞."""

# –ù–ê:
class KnowledgeGraphBuilder:
    """
    Knowledge Graph Builder –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤ –°–∞—Ä—Å–µ–∫–µ–Ω–æ–≤–∞.
    
    –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï:
    –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ –∏–∑ SarsekenovProcessor (ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä)
    –∏ —Å—Ç—Ä–æ–∏—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Knowledge Graph —Å —É–∑–ª–∞–º–∏ –∏ —Å–≤—è–∑—è–º–∏ –¥–ª—è AI-–±–æ—Ç–∞.
    
    –§–ò–õ–û–°–û–§–ò–Ø:
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    - –ú–∞–∫—Å–∏–º—É–º —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –∫–æ–Ω—Ü–µ–ø—Ç–∞–º–∏
    - –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è (10+ —Ç–∏–ø–æ–≤)
    - Reasoning chains –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
    - API –¥–ª—è AI-–±–æ—Ç–∞: find_practices, recommend_exercise
    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
    """
```


### **1.3. –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö**

–ï—Å–ª–∏ –µ—Å—Ç—å –∏–º–ø–æ—Ä—Ç—ã —Å—Ç–∞—Ä–æ–≥–æ –∫–ª–∞—Å—Å–∞, –æ–±–Ω–æ–≤–∏—Ç—å:

```python
# –°—Ç–∞—Ä–æ–µ:
from text_processor.orchestrator.sarsekenov_processor import SarsekenovProcessor

# –ù–æ–≤–æ–µ:
from text_processor.orchestrator.knowledge_graph_builder import KnowledgeGraphBuilder
```


***

## üìã **–®–ê–ì 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä**

### **2.1. –û—Ç–∫—Ä—ã—Ç—å `text_processor/sarsekenov_processor.py`**

### **2.2. –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ (–ø–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤)**

```python
# –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏:
from .prerequisite_extractor import PrerequisiteExtractor

# –î–û–ë–ê–í–ò–¢–¨:
from .orchestrator.knowledge_graph_builder import KnowledgeGraphBuilder
from .orchestrator.knowledge_graph import KnowledgeGraph
```


### **2.3. –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `__init__` –∫–ª–∞—Å—Å–∞ `SarsekenovProcessor`**

–ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É:

```python
def __init__(self, primary_model: str = "gpt-4o-mini", refine_model: str = "gpt-5-mini"):
```

–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü –º–µ—Ç–æ–¥–∞ `__init__` (–ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π —Å—Ç—Ä–æ–∫–æ–π –º–µ—Ç–æ–¥–∞):

```python
        # üöÄ Knowledge Graph Builder (–¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö —Å–≤—è–∑–µ–π)
        kg_config = self.config.get('pipeline', {}).get('knowledge_graph', {})
        self.build_knowledge_graph = kg_config.get('enabled', True)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω
        
        if self.build_knowledge_graph:
            self.graph_builder = KnowledgeGraphBuilder()
            print("[INFO] Knowledge Graph Builder: ENABLED")
        else:
            self.graph_builder = None
            print("[INFO] Knowledge Graph Builder: DISABLED")
```


***

## üìã **–®–ê–ì 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ-–±–∏–ª–¥–µ—Ä–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏**

### **3.1. –ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ `process_file` –≤ `sarsekenov_processor.py`**

### **3.2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –ü–û–°–õ–ï –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤**

–ù–∞–π—Ç–∏ –±–ª–æ–∫ –∫–æ–¥–∞ (–ø—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 1100-1200):

```python
        # –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å ¬´–∫–æ—Ä–æ—Ç–∫–æ–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ¬ª –∏ ¬´–æ–±—â–µ–µ —Ä–µ–∑—é–º–µ¬ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤
        overview = self.generate_overview(doc)
```

**–î–û–ë–ê–í–ò–¢–¨ –ü–ï–†–ï–î `overview = ...`:**

```python
        # üöÄ –ü–û–°–¢–†–û–ï–ù–ò–ï KNOWLEDGE GRAPH (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
        knowledge_graph_data = None
        if self.graph_builder:
            print("[INFO] Building Knowledge Graph...")
            knowledge_graph_data = self._build_knowledge_graph_from_blocks(all_blocks, video_id)
            print(f"[SUCCESS] Knowledge Graph built: {len(knowledge_graph_data.get('nodes', []))} nodes, "
                  f"{len(knowledge_graph_data.get('edges', []))} edges")
```


### **3.3. –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç**

–ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É:

```python
        doc.update({
            "overview_toc": overview.get("overview_toc", ""),
            "overview_summary": overview.get("overview_summary", ""),
            "graph_entities": top_document_entities,
```

**–ò–ó–ú–ï–ù–ò–¢–¨ –ù–ê:**

```python
        doc.update({
            "overview_toc": overview.get("overview_toc", ""),
            "overview_summary": overview.get("overview_summary", ""),
            "graph_entities": top_document_entities,
            "semantic_relationships": document_semantic_analysis,
            "total_graph_nodes": len(self.graph_nodes),
            "total_graph_relationships": len(self.graph_relationships),
            
            # üöÄ –ù–û–í–û–ï: Knowledge Graph (–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ)
            "knowledge_graph": knowledge_graph_data,  # –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä–∞—Ñ –≤ –¥–æ–∫—É–º–µ–Ω—Ç
        })
```


### **3.4. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞ –≤ –∫–ª–∞—Å—Å `SarsekenovProcessor`**

**–î–û–ë–ê–í–ò–¢–¨ –í –ö–û–ù–ï–¶ –ö–õ–ê–°–°–ê (–ø–µ—Ä–µ–¥ –ø–æ—Å–ª–µ–¥–Ω–∏–º –º–µ—Ç–æ–¥–æ–º):**

```python
    def _build_knowledge_graph_from_blocks(self, blocks: List[Dict[str, Any]], video_id: str) -> Optional[Dict]:
        """
        –ü–æ—Å—Ç—Ä–æ–∏—Ç—å Knowledge Graph –∏–∑ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤.
        
        –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ –≤ –µ–¥–∏–Ω—ã–π –≥—Ä–∞—Ñ:
        - –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤ ‚Üí —É–∑–ª—ã —Ç–∏–ø–∞ CONCEPT
        - –ü—Ä–∞–∫—Ç–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏ ‚Üí —É–∑–ª—ã —Ç–∏–ø–∞ PRACTICE/TECHNIQUE
        - –ü—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ ‚Üí —É–∑–ª—ã —Ç–∏–ø–∞ PROCESS_STAGE
        - –ü–∞—Ç—Ç–µ—Ä–Ω—ã –°–∞—Ä—Å–µ–∫–µ–Ω–æ–≤–∞ ‚Üí —É–∑–ª—ã —Ç–∏–ø–∞ PATTERN
        - –°–≤—è–∑–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ ‚Üí —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–±—Ä–∞
        
        Args:
            blocks: –°–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
            video_id: ID –≤–∏–¥–µ–æ
            
        Returns:
            Dict —Å –≥—Ä–∞—Ñ–æ–º –∏–ª–∏ None –µ—Å–ª–∏ –≥—Ä–∞—Ñ-–±–∏–ª–¥–µ—Ä –æ—Ç–∫–ª—é—á–µ–Ω
        """
        if not self.graph_builder:
            return None
        
        # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∂–¥—ã–π –±–ª–æ–∫ —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ-–±–∏–ª–¥–µ—Ä
        for block in blocks:
            # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ-–±–∏–ª–¥–µ—Ä–∞
            validation_result = {
                "is_valid": True,
                "reason": "Block processed by SAG v2.0",
                "metrics": {
                    "density": block.get("complexity_score", 5.0) / 10.0,
                    "sarsekenov_entity_count": len(block.get("graph_entities", []))
                }
            }
            
            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
            patterns_result = {
                "patterns": []
            }
            
            # –ü—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏
            chains_result = {
                "chains": block.get("causal_chains", [])
            }
            
            # –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤
            hierarchy_result = {
                "valid": True if block.get("concept_hierarchy") else False,
                "hierarchy": self._convert_hierarchy_to_graph_format(
                    block.get("concept_hierarchy", [])
                ) if block.get("concept_hierarchy") else None
            }
            
            # –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ –∏–∑ –±–ª–æ–∫–∞
            try:
                self.graph_builder._build_graph_from_results(
                    text_id=block["block_id"],
                    validation=type('obj', (object,), validation_result),  # Mock object
                    patterns_result=patterns_result,
                    chains_result=chains_result,
                    hierarchy_result=hierarchy_result
                )
            except Exception as e:
                print(f"[WARNING] Failed to build graph for block {block['block_id']}: {e}")
                continue
        
        # –ü–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ
        kg = self.graph_builder.get_knowledge_graph()
        
        # –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ dict –¥–ª—è JSON
        return {
            "nodes": [node.to_dict() for node in kg.nodes.values()],
            "edges": [edge.to_dict() for edge in kg.edges],
            "metadata": {
                "video_id": video_id,
                "total_nodes": len(kg.nodes),
                "total_edges": len(kg.edges),
                "node_types": self._count_node_types(kg),
                "edge_types": self._count_edge_types(kg)
            }
        }
    
    def _convert_hierarchy_to_graph_format(self, concept_hierarchy: List[Dict]) -> Dict:
        """
        –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å concept_hierarchy –∏–∑ SAG —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –≥—Ä–∞—Ñ-–±–∏–ª–¥–µ—Ä–∞.
        
        Args:
            concept_hierarchy: –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ü–µ–ø—Ç–æ–≤ –∏–∑ ConceptHierarchyExtractor
            
        Returns:
            Dict –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è KnowledgeGraphBuilder
        """
        if not concept_hierarchy:
            return {
                "root": {"name": "–Ω–µ–π—Ä–æ—Å—Ç–∞–ª–∫–∏–Ω–≥", "description": ""},
                "domains": [],
                "practices": [],
                "techniques": [],
                "exercises": [],
                "cross_connections": []
            }
        
        hierarchy_dict = {
            "root": {"name": "–Ω–µ–π—Ä–æ—Å—Ç–∞–ª–∫–∏–Ω–≥", "description": "–°–∏—Å—Ç–µ–º–∞ –º–µ—Ç–∞–Ω–∞–±–ª—é–¥–µ–Ω–∏—è"},
            "domains": [],
            "practices": [],
            "techniques": [],
            "exercises": [],
            "cross_connections": []
        }
        
        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É—Ä–æ–≤–Ω—è–º
        for concept in concept_hierarchy:
            level = concept.get("level", "unknown")
            name = concept.get("name", "")
            parent = concept.get("parent", "–Ω–µ–π—Ä–æ—Å—Ç–∞–ª–∫–∏–Ω–≥")
            description = concept.get("description", "")
            
            if level == "root":
                hierarchy_dict["root"] = {
                    "name": name,
                    "description": description,
                    "sarsekenov_terms": [name]
                }
            elif level == "domain":
                hierarchy_dict["domains"].append({
                    "name": name,
                    "description": description,
                    "sarsekenov_terms": [name],
                    "parent": parent
                })
            elif level == "practice":
                hierarchy_dict["practices"].append({
                    "name": name,
                    "description": description,
                    "sarsekenov_terms": [name],
                    "parent": parent
                })
            elif level == "technique":
                hierarchy_dict["techniques"].append({
                    "name": name,
                    "description": description,
                    "sarsekenov_terms": [name],
                    "parent": parent
                })
            elif level == "exercise":
                hierarchy_dict["exercises"].append({
                    "name": name,
                    "description": description,
                    "parent": parent,
                    "duration": concept.get("duration"),
                    "frequency": concept.get("frequency"),
                    "instructions": concept.get("instructions", [])
                })
            
            # Cross-connections –∏–∑ relationships
            relationship = concept.get("relationship")
            if relationship and relationship != "is_core_component_of":
                hierarchy_dict["cross_connections"].append({
                    "from_concept": parent,
                    "to_concept": name,
                    "relation": self._map_relationship_to_graph(relationship),
                    "explanation": description
                })
        
        return hierarchy_dict
    
    def _map_relationship_to_graph(self, relationship: str) -> str:
        """–ú–∞–ø–ø–∏–Ω–≥ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç –≥—Ä–∞—Ñ-–±–∏–ª–¥–µ—Ä–∞"""
        mapping = {
            "enables": "enables",
            "requires": "requires",
            "leads_to": "leads_to",
            "transforms_into": "transforms_into",
            "is_practice_for": "requires",
            "is_technique_for": "requires",
            "is_exercise_for": "requires"
        }
        return mapping.get(relationship, "related_to")
    
    def _count_node_types(self, kg: KnowledgeGraph) -> Dict[str, int]:
        """–ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞"""
        counts = {}
        for node in kg.nodes.values():
            node_type = node.node_type.value
            counts[node_type] = counts.get(node_type, 0) + 1
        return counts
    
    def _count_edge_types(self, kg: KnowledgeGraph) -> Dict[str, int]:
        """–ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞"""
        counts = {}
        for edge in kg.edges:
            edge_type = edge.edge_type.value
            counts[edge_type] = counts.get(edge_type, 0) + 1
        return counts
```


***

## üìã **–®–ê–ì 4: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**

### **4.1. –û—Ç–∫—Ä—ã—Ç—å `config.yaml`**

### **4.2. –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é knowledge_graph**

–ù–∞–π—Ç–∏ —Å–µ–∫—Ü–∏—é `pipeline` –∏ –¥–æ–±–∞–≤–∏—Ç—å:

```yaml
pipeline:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ...
  
  sag_v2:
    use_safety_extractor: true
    use_causal_chain_extractor: true
    use_concept_hierarchy_extractor: true
    use_case_study_extractor: true
    use_prerequisite_extractor: true
    models:
      safety: gpt-4o-mini
      causal: gpt-4o-mini
      hierarchy: gpt-4o-mini
      case_study: gpt-4o-mini
      prerequisite: gpt-4o-mini
  
  # üöÄ –ù–û–í–ê–Ø –°–ï–ö–¶–ò–Ø: Knowledge Graph
  knowledge_graph:
    enabled: true  # –í–∫–ª—é—á–∏—Ç—å –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö —Å–≤—è–∑–µ–π
    export_formats:
      - json  # –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≥—Ä–∞—Ñ –≤ JSON (–≤—Å–µ–≥–¥–∞)
      - neo4j  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —ç–∫—Å–ø–æ—Ä—Ç –≤ Neo4j (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
    neo4j:
      uri: "bolt://localhost:7687"
      user: "neo4j"
      password: "password"
    reasoning:
      max_chain_depth: 5  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ reasoning chains
      confidence_threshold: 0.7  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
```


***

## üìã **–®–ê–ì 5: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è AI-–±–æ—Ç–∞**

### **5.1. –î–æ–±–∞–≤–∏—Ç—å helper-–º–µ—Ç–æ–¥—ã –≤ –∫–æ–Ω–µ—Ü `sarsekenov_processor.py`**

```python
    def get_knowledge_graph_api(self) -> Optional[KnowledgeGraphBuilder]:
        """
        –ü–æ–ª—É—á–∏—Ç—å API Knowledge Graph –¥–ª—è AI-–±–æ—Ç–∞.
        
        –ü–æ–∑–≤–æ–ª—è–µ—Ç AI-–±–æ—Ç—É:
        - –ò—Å–∫–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Å–∏–º–ø—Ç–æ–º–æ–≤
        - –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        - –°—Ç—Ä–æ–∏—Ç—å reasoning chains
        
        Returns:
            KnowledgeGraphBuilder –∏–ª–∏ None –µ—Å–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω
        """
        return self.graph_builder
    
    def find_practices_for_symptom(self, symptom: str) -> List[Dict]:
        """
        AI-–±–æ—Ç API: –ù–∞–π—Ç–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏–º–ø—Ç–æ–º–æ–º.
        
        Args:
            symptom: –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏–º–ø—Ç–æ–º–∞ (–Ω–∞–ø—Ä. "–∑–∞—Ö–≤–∞—Ç –≤–Ω–∏–º–∞–Ω–∏—è", "–æ–±–∏–¥–∞")
            
        Returns:
            –°–ø–∏—Å–æ–∫ –ø—Ä–∞–∫—Ç–∏–∫ —Å reasoning chains
        """
        if not self.graph_builder:
            return []
        return self.graph_builder.find_practices_for_symptom(symptom)
    
    def recommend_exercise(self, practice: str, duration: Optional[str] = None) -> Optional[Dict]:
        """
        AI-–±–æ—Ç API: –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏.
        
        Args:
            practice: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ (–Ω–∞–ø—Ä. "–º–µ—Ç–∞–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ")
            duration: –ñ–µ–ª–∞–µ–º–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä. "5-10 –º–∏–Ω—É—Ç")
            
        Returns:
            Dict —Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º –∏–ª–∏ None
        """
        if not self.graph_builder:
            return None
        return self.graph_builder.recommend_exercise(practice, duration)
```


***

## üìã **–®–ê–ì 6: –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≥—Ä–∞—Ñ–∞**

### **6.1. –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `save_markdown` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞**

–ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ `save_markdown` –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ –µ–≥–æ –≤—ã–∑–æ–≤–æ–º:

```python
    def save_knowledge_graph(self, kg_path: Path, knowledge_graph: Dict) -> None:
        """
        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å Knowledge Graph –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª.
        
        Args:
            kg_path: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞
            knowledge_graph: –î–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∞
        """
        if not knowledge_graph:
            return
        
        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å JSON
        with open(kg_path, "wb") as f:
            f.write(orjson.dumps(knowledge_graph, option=orjson.OPT_INDENT_2))
        
        print(f"[SUCCESS] Knowledge Graph: {kg_path}")
        
        # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —ç–∫—Å–ø–æ—Ä—Ç –≤ Neo4j
        kg_config = self.config.get('pipeline', {}).get('knowledge_graph', {})
        if 'neo4j' in kg_config.get('export_formats', []):
            self._export_to_neo4j(knowledge_graph, kg_config.get('neo4j', {}))
    
    def _export_to_neo4j(self, knowledge_graph: Dict, neo4j_config: Dict) -> None:
        """–≠–∫—Å–ø–æ—Ä—Ç –≥—Ä–∞—Ñ–∞ –≤ Neo4j (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"""
        try:
            from neo4j import GraphDatabase
            
            driver = GraphDatabase.driver(
                neo4j_config.get('uri', 'bolt://localhost:7687'),
                auth=(neo4j_config.get('user', 'neo4j'), neo4j_config.get('password', 'password'))
            )
            
            with driver.session() as session:
                # –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
                session.run("MATCH (n) DETACH DELETE n")
                
                # –°–æ–∑–¥–∞—Ç—å —É–∑–ª—ã
                for node in knowledge_graph.get('nodes', []):
                    session.run(
                        "CREATE (n:Node {id: $id, name: $name, type: $type})",
                        id=node['id'],
                        name=node['name'],
                        type=node['node_type']
                    )
                
                # –°–æ–∑–¥–∞—Ç—å —Å–≤—è–∑–∏
                for edge in knowledge_graph.get('edges', []):
                    session.run(
                        "MATCH (a {id: $from_id}), (b {id: $to_id}) "
                        "CREATE (a)-[r:RELATION {type: $type}]->(b)",
                        from_id=edge['from_id'],
                        to_id=edge['to_id'],
                        type=edge['edge_type']
                    )
            
            driver.close()
            print("[SUCCESS] Exported to Neo4j")
            
        except ImportError:
            print("[WARNING] neo4j package not installed. Skipping Neo4j export.")
        except Exception as e:
            print(f"[WARNING] Failed to export to Neo4j: {e}")
```


### **6.2. –û–±–Ω–æ–≤–∏—Ç—å –≤—ã–∑–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ `process_file`**

–ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏:

```python
        json_path = output_dir / f"{base}.for_vector.json"
        md_path = output_dir / f"{base}.for_review.md"
        with open(json_path, "wb") as f:
            f.write(orjson.dumps(doc, option=orjson.OPT_INDENT_2))
        self.save_markdown(md_path, doc, base)
```

**–ò–ó–ú–ï–ù–ò–¢–¨ –ù–ê:**

```python
        json_path = output_dir / f"{base}.for_vector.json"
        md_path = output_dir / f"{base}.for_review.md"
        kg_path = output_dir / f"{base}.knowledge_graph.json"  # –ù–æ–≤—ã–π —Ñ–∞–π–ª
        
        with open(json_path, "wb") as f:
            f.write(orjson.dumps(doc, option=orjson.OPT_INDENT_2))
        
        self.save_markdown(md_path, doc, base)
        
        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å Knowledge Graph –æ—Ç–¥–µ–ª—å–Ω–æ
        if doc.get("knowledge_graph"):
            self.save_knowledge_graph(kg_path, doc["knowledge_graph"])
```


***

## üìã **–®–ê–ì 7: –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≤ Vector DB**

### **7.1. –û—Ç–∫—Ä—ã—Ç—å `vector_db/vector_indexer.py`**

### **7.2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≥—Ä–∞—Ñ–∞**

–ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ `index_file` –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≥—Ä–∞—Ñ-—Å—É—â–Ω–æ—Å—Ç–µ–π:

```python
        # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –±–ª–æ–∫–æ–≤ –∏ —Å—É—â–Ω–æ—Å—Ç–µ–π ...
        
        # üöÄ –ù–û–í–û–ï: –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è Knowledge Graph
        if 'knowledge_graph' in data and data['knowledge_graph']:
            self._index_knowledge_graph(data['knowledge_graph'], document_id)
```


### **7.3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞**

```python
    def _index_knowledge_graph(self, knowledge_graph: Dict, document_id: str) -> None:
        """
        –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å Knowledge Graph –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é.
        
        Args:
            knowledge_graph: –î–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∞
            document_id: ID –¥–æ–∫—É–º–µ–Ω—Ç–∞
        """
        # –ü–æ–ª—É—á–∏—Ç—å/—Å–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é –¥–ª—è –≥—Ä–∞—Ñ–∞
        collection = self.db_manager.get_or_create_collection(
            name="sag_v2_knowledge_graph",
            metadata={"description": "Knowledge Graph nodes and edges"}
        )
        
        # –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —É–∑–ª—ã
        nodes = knowledge_graph.get('nodes', [])
        if nodes:
            node_ids = [f"{document_id}_node_{node['id']}" for node in nodes]
            node_texts = [
                f"{node['name']}: {node.get('description', '')}"
                for node in nodes
            ]
            node_metadatas = [
                {
                    "document_id": document_id,
                    "node_id": node['id'],
                    "node_type": node['node_type'],
                    "node_name": node['name']
                }
                for node in nodes
            ]
            
            embeddings = self.embedding_service.get_embeddings(node_texts)
            collection.add(
                ids=node_ids,
                embeddings=embeddings,
                documents=node_texts,
                metadatas=node_metadatas
            )
            
            self.logger.info(f"‚úÖ –ü—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞: {len(nodes)}")
```


***

## üìã **–®–ê–ì 8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **8.1. –ó–∞–ø—É—Å—Ç–∏—Ç—å pipeline**

```bash
python pipeline_orchestrator.py --config config.yaml
```


### **8.2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤**

–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏:

```
[INFO] Knowledge Graph Builder: ENABLED
[INFO] Building Knowledge Graph...
[SUCCESS] Knowledge Graph built: 45 nodes, 78 edges
[SUCCESS] Knowledge Graph: data/sag_final/2025/06/{video_id}.knowledge_graph.json
‚úÖ –ü—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞: 45
```


### **8.3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**

```bash
# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
ls data/sag_final/2025/06/

# –û–∂–∏–¥–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã:
# - {video_id}.for_vector.json (—Å –ø–æ–ª–µ–º knowledge_graph)
# - {video_id}.knowledge_graph.json (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –≥—Ä–∞—Ñ–∞)
# - {video_id}.for_review.md (markdown –¥–ª—è review)
```


### **8.4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É JSON**

```bash
cat data/sag_final/2025/06/{video_id}.for_vector.json | jq .knowledge_graph

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
# {
#   "nodes": [...],
#   "edges": [...],
#   "metadata": {
#     "total_nodes": 45,
#     "total_edges": 78,
#     ...
#   }
# }
```


***

## üìã **–®–ê–ì 9: API –¥–ª—è AI-–±–æ—Ç–∞**

### **9.1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `examples/ai_bot_usage.py`:

```python
"""
–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Knowledge Graph API –¥–ª—è AI-–±–æ—Ç–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞
"""
from text_processor.sarsekenov_processor import SarsekenovProcessor

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
processor = SarsekenovProcessor()

# –ü–æ–ª—É—á–∏—Ç—å –≥—Ä–∞—Ñ API
graph_api = processor.get_knowledge_graph_api()

if graph_api:
    # 1. –ü–æ–∏—Å–∫ –ø—Ä–∞–∫—Ç–∏–∫ –¥–ª—è —Å–∏–º–ø—Ç–æ–º–∞
    practices = graph_api.find_practices_for_symptom("–∑–∞—Ö–≤–∞—Ç –≤–Ω–∏–º–∞–Ω–∏—è")
    print("–ü—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è '–∑–∞—Ö–≤–∞—Ç –≤–Ω–∏–º–∞–Ω–∏—è':")
    for p in practices:
        print(f"  - {p['practice']}: {p['explanation']}")
    
    # 2. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
    exercise = graph_api.recommend_exercise(
        practice="–º–µ—Ç–∞–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
        duration="5-10 –º–∏–Ω—É—Ç"
    )
    if exercise:
        print(f"\n–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: {exercise['exercise']}")
        print(f"–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {exercise['duration']}")
        print(f"–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: {exercise['instructions']}")
```


***

## ‚úÖ **–ß–ï–ö–õ–ò–°–¢ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò**

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- [ ] –§–∞–π–ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω: `knowledge_graph_builder.py` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –ö–ª–∞—Å—Å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω: `KnowledgeGraphBuilder` –≤–º–µ—Å—Ç–æ `SarsekenovProcessor`
- [ ] –ò–º–ø–æ—Ä—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ `sarsekenov_processor.py`
- [ ] –ú–µ—Ç–æ–¥ `_build_knowledge_graph_from_blocks` –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] –ö–æ–Ω—Ñ–∏–≥ `config.yaml` –æ–±–Ω–æ–≤–ª–µ–Ω —Å —Å–µ–∫—Ü–∏–µ–π `knowledge_graph`
- [ ] API –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã: `find_practices_for_symptom`, `recommend_exercise`
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç: —Ñ–∞–π–ª `*.knowledge_graph.json` —Å–æ–∑–¥–∞–µ—Ç—Å—è
- [ ] –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ –≤ Vector DB —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Pipeline –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç: "Knowledge Graph built: X nodes, Y edges"

***

## üéØ **–û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢**

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

‚úÖ **–§–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∏–¥–µ–æ:**

```
data/sag_final/2025/06/
‚îú‚îÄ‚îÄ {video_id}.for_vector.json (—Å –ø–æ–ª–µ–º knowledge_graph)
‚îú‚îÄ‚îÄ {video_id}.knowledge_graph.json (–æ—Ç–¥–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ)
‚îî‚îÄ‚îÄ {video_id}.for_review.md
```

‚úÖ **JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```json
{
  "knowledge_graph": {
    "nodes": [
      {"id": "...", "name": "–º–µ—Ç–∞–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "node_type": "CONCEPT"},
      {"id": "...", "name": "—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ", "node_type": "PRACTICE"}
    ],
    "edges": [
      {"from_id": "...", "to_id": "...", "edge_type": "IS_PRACTICE_FOR"}
    ],
    "metadata": {
      "total_nodes": 45,
      "total_edges": 78
    }
  }
}
```

‚úÖ **API –¥–ª—è AI-–±–æ—Ç–∞:**

```python
# –ü–æ–∏—Å–∫ –ø—Ä–∞–∫—Ç–∏–∫
practices = processor.find_practices_for_symptom("–æ–±–∏–¥–∞")
# ‚Üí [{"practice": "–º–µ—Ç–∞–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "relation": "enables", ...}]

# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
exercise = processor.recommend_exercise("–º–µ—Ç–∞–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", duration="5 –º–∏–Ω—É—Ç")
# ‚Üí {"exercise": "–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –¥—ã—Ö–∞–Ω–∏–µ–º", "instructions": [...]}
```


***

**–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

